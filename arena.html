<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>SR Arena Screen</title>

        <script src="bower_components/webcomponentsjs/webcomponents.min.js"></script>

        <link rel="import" href="components/sr-comp/component.html" />
        <link rel="import" href="components/sr-arena/component.html" />
        <link rel="import" href="components/sr-arena-picker/component.html" />

        <style>
            body {
                position: fixed;
                width: 100%;
                height: 100%;
                top: 0;
                right: 0;
                bottom: 0;
                left: 0;
                margin: 0;
                padding: 0;

                font-family: 'Open Sans', sans-serif;
                background: black;
                color: white;
                font-size: 100%;
            }

            #arena {
                height: 100%;
            }
        </style>
    </head>

    <body>
        <sr-comp id="comp" apiurl="http://localhost:5112/comp-api" streamurl="http://localhost:5001"></sr-comp>

        <sr-arena-picker id="picker" hidden></sr-arena-picker>
        <sr-arena id="arena" hidden></sr-arena>

        <script>
            var parseArguments = function() {
                var fragment = window.location.search;
                var tokens = fragment.substr(1).split(',');
                return {arena: tokens[0], corner: tokens[1]};
            };

            document.addEventListener('polymer-ready', function() {
                var args = parseArguments();

                var comp = document.querySelector('#comp');

                if (args.arena == null || args.corner == null) {
                    var picker = document.querySelector('#picker');
                    picker.hidden = false;
                    picker.comp = comp;
                } else {
                    comp.api.getArena(args.arena, function(compArena) {
                        comp.api.getCorner(args.corner, function(compCorner) {
                            if (compArena && compCorner) {
                                var arena = document.querySelector('#arena');
                                arena.hidden = false;
                                arena.arena = args.arena;
                                arena.maincorner = args.corner;
                                arena.comp = comp;
                            } else {
                                var picker = document.querySelector('#picker');
                                picker.hidden = false;
                                picker.comp = comp;
                            }
                        });
                    });
                }
            });
        </script>
    </body>
</html>
